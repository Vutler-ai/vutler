<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Vutler ‚Äî Pixel Office</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');
  * { margin:0; padding:0; box-sizing:border-box; }
  body { background:#0A1628; font-family:'Press Start 2P',monospace; overflow:hidden; height:100vh; }
  #ui-bar { position:fixed; top:0; left:0; right:0; height:48px; background:rgba(10,22,40,.95); border-bottom:2px solid #3B82F6; display:flex; align-items:center; padding:0 20px; z-index:100; gap:16px; }
  #ui-bar .logo { color:#3B82F6; font-size:14px; letter-spacing:2px; }
  #ui-bar .stats { margin-left:auto; display:flex; gap:18px; font-size:9px; color:#94a3b8; }
  #ui-bar .stats span { display:flex; align-items:center; gap:6px; }
  .dot { width:8px; height:8px; border-radius:50%; display:inline-block; }
  .dot-green { background:#22c55e; box-shadow:0 0 6px #22c55e; }
  .dot-yellow { background:#eab308; box-shadow:0 0 6px #eab308; }
  .dot-red { background:#ef4444; box-shadow:0 0 6px #ef4444; }
  canvas { display:block; margin-top:48px; cursor:pointer; }

  /* Popup */
  #popup { display:none; position:fixed; z-index:200; background:#0f1d32; border:2px solid #3B82F6; border-radius:8px; padding:16px 20px; color:#e2e8f0; font-family:'Press Start 2P',monospace; font-size:9px; line-height:1.8; min-width:260px; box-shadow:0 0 30px rgba(59,130,246,.3); }
  #popup .close { position:absolute; top:8px; right:12px; cursor:pointer; color:#3B82F6; font-size:12px; }
  #popup .agent-name { font-size:13px; color:#3B82F6; margin-bottom:8px; }
  #popup .status-badge { display:inline-block; padding:2px 8px; border-radius:4px; font-size:8px; }
  .sb-running { background:#22c55e33; color:#22c55e; border:1px solid #22c55e; }
  .sb-idle { background:#eab30833; color:#eab308; border:1px solid #eab308; }
  .sb-stopped { background:#ef444433; color:#ef4444; border:1px solid #ef4444; }
  .sb-waiting { background:#8b5cf633; color:#8b5cf6; border:1px solid #8b5cf6; }
</style>
</head>
<body>
<div id="ui-bar">
  <span class="logo">‚¨° VUTLER OFFICE</span>
  <div class="stats" id="stats"></div>
</div>
<canvas id="c"></canvas>
<div id="popup"><span class="close" onclick="document.getElementById('popup').style.display='none'">‚úï</span><div id="popup-content"></div></div>

<script>
// ‚îÄ‚îÄ Mock Data ‚îÄ‚îÄ
const AGENTS = [
  { id:'jarvis',   name:'Jarvis',   emoji:'ü§ñ', role:'Coordinator & Strategy',  zone:'ops',   status:'running', lastActivity:'Orchestrating sprint planning', color:'#3B82F6' },
  { id:'andrea',   name:'Andrea',   emoji:'üìã', role:'Office Manager & Admin',   zone:'ops',   status:'running', lastActivity:'Processing invoices batch #47', color:'#f472b6' },
  { id:'mike',     name:'Mike',     emoji:'‚öôÔ∏è', role:'Lead Engineer',            zone:'eng',   status:'running', lastActivity:'Refactoring auth middleware', color:'#22d3ee' },
  { id:'philip',   name:'Philip',   emoji:'üé®', role:'UI/UX Designer',           zone:'eng',   status:'running', lastActivity:'Building pixel office proto', color:'#a78bfa' },
  { id:'luna',     name:'Luna',     emoji:'üß™', role:'Product Manager',          zone:'eng',   status:'idle',    lastActivity:'Reviewing feature specs', color:'#fbbf24' },
  { id:'max',      name:'Max',      emoji:'üìà', role:'Marketing & Growth',       zone:'mkt',   status:'running', lastActivity:'A/B testing landing page v3', color:'#34d399' },
  { id:'oscar',    name:'Oscar',    emoji:'üìù', role:'Content & Copywriting',    zone:'mkt',   status:'waiting', lastActivity:'Waiting for brand guidelines', color:'#fb923c' },
  { id:'nora',     name:'Nora',     emoji:'üéÆ', role:'Community Manager',        zone:'mkt',   status:'idle',    lastActivity:'Monitoring Discord channels', color:'#f87171' },
  { id:'victor',   name:'Victor',   emoji:'üí∞', role:'Commercial / Sales',       zone:'sales', status:'running', lastActivity:'Following up lead #234', color:'#fbbf24' },
  { id:'stephen',  name:'Stephen',  emoji:'üìñ', role:'Spiritual Research',       zone:'research', status:'idle', lastActivity:'Deep dive: consciousness models', color:'#c084fc' },
  { id:'sentinel', name:'Sentinel', emoji:'üì∞', role:'News Intelligence',        zone:'research', status:'running', lastActivity:'Scanning 47 RSS feeds', color:'#38bdf8' },
  { id:'marcus',   name:'Marcus',   emoji:'üìä', role:'Portfolio Manager',        zone:'research', status:'waiting', lastActivity:'Awaiting market open', color:'#4ade80' },
  { id:'rex',      name:'Rex',      emoji:'üõ°Ô∏è', role:'VPS Monitor',             zone:'server', status:'running', lastActivity:'All 6 nodes healthy ‚úì', color:'#f43f5e' },
];

// ‚îÄ‚îÄ Canvas Setup ‚îÄ‚îÄ
const canvas = document.getElementById('c');
const ctx = canvas.getContext('2d');
let W, H, scale=1;
function resize() {
  W = window.innerWidth; H = window.innerHeight - 48;
  scale = Math.min(W/1200, H/800);
  canvas.width = W; canvas.height = H;
}
window.addEventListener('resize', resize); resize();

// ‚îÄ‚îÄ Pixel Art Helpers ‚îÄ‚îÄ
function drawPixelChar(x, y, agent, frame) {
  const s = 4 * scale; // pixel size
  const status = agent.status;
  const c = agent.color;
  const dark = shadeColor(c, -40);

  ctx.save();
  ctx.translate(x, y);

  if (status === 'stopped') {
    // Empty chair
    drawChair(0, 0, s);
    ctx.restore(); return;
  }

  // Chair
  drawChair(0, 0, s);

  // Body bob for running
  const bob = status === 'running' ? Math.sin(frame * 0.15 + AGENTS.indexOf(agent)) * 1.5 * scale : 0;

  // Body (torso)
  ctx.fillStyle = c;
  fillBox(-3*s, -12*s + bob, 6*s, 6*s);
  // Head
  ctx.fillStyle = '#fcd5b0';
  fillBox(-2*s, -18*s + bob, 4*s, 5*s);
  // Hair
  ctx.fillStyle = dark;
  fillBox(-2*s, -19*s + bob, 4*s, 2*s);
  // Eyes
  ctx.fillStyle = '#1e293b';
  const blink = Math.random() < 0.005;
  if (!blink) { fillBox(-1*s, -16*s + bob, s, s); fillBox(1*s, -16*s + bob, s, s); }

  // Arms
  if (status === 'running') {
    const armOff = Math.sin(frame * 0.2 + AGENTS.indexOf(agent) * 2) * 2 * scale;
    ctx.fillStyle = c;
    fillBox(-4*s, -10*s + bob + armOff, s, 4*s);
    fillBox(3*s, -10*s + bob - armOff, s, 4*s);
    // Keyboard typing sparks
    if (frame % 8 < 4) {
      ctx.fillStyle = '#3B82F6';
      fillBox((-2 + Math.floor(Math.random()*4))*s, -4*s, s, s);
    }
  } else {
    ctx.fillStyle = c;
    fillBox(-4*s, -10*s, s, 4*s);
    fillBox(3*s, -10*s, s, 4*s);
  }

  // Legs
  ctx.fillStyle = '#334155';
  fillBox(-2*s, -6*s, 2*s, 4*s);
  fillBox(1*s, -6*s, 2*s, 4*s);

  // Waiting bubble
  if (status === 'waiting') {
    const bFloat = Math.sin(frame * 0.08) * 3 * scale;
    ctx.fillStyle = 'white';
    roundRect(-4*s, -26*s + bFloat, 8*s, 6*s, 3*scale);
    ctx.fill();
    ctx.fillStyle = '#1e293b';
    ctx.font = `${10*scale}px 'Press Start 2P'`;
    ctx.textAlign = 'center';
    ctx.fillText('?', 0, -21.5*s + bFloat);
  }

  ctx.restore();

  // Desk
  ctx.fillStyle = '#1e3a5f';
  fillBox(x - 5*s, y - 4*s, 10*s, 2*s);
  // Monitor
  ctx.fillStyle = status === 'running' ? '#3B82F6' : '#1e293b';
  fillBox(x - 3*s, y - 8*s, 6*s, 4*s);
  ctx.fillStyle = '#0f172a';
  fillBox(x - 0.5*s, y - 4*s, s, s);

  // Screen glow for running
  if (status === 'running') {
    ctx.fillStyle = `rgba(59,130,246,${0.1 + Math.sin(frame*0.1)*0.05})`;
    fillBox(x - 2.5*s, y - 7.5*s, 5*s, 3*s);
  }

  // Name + emoji label
  ctx.fillStyle = '#94a3b8';
  ctx.font = `${8*scale}px 'Press Start 2P'`;
  ctx.textAlign = 'center';
  ctx.fillText(`${agent.emoji} ${agent.name}`, x, y + 6*s);

  // Status dot
  const dotColors = { running:'#22c55e', idle:'#eab308', stopped:'#ef4444', waiting:'#8b5cf6' };
  ctx.fillStyle = dotColors[status];
  ctx.beginPath();
  ctx.arc(x + ctx.measureText(`${agent.emoji} ${agent.name}`).width/2 + 6*scale, y + 5.5*s, 3*scale, 0, Math.PI*2);
  ctx.fill();
}

function drawChair(x, y, s) {
  ctx.fillStyle = '#334155';
  fillBox(x - 3*s, y - 2*s, 6*s, 2*s);
  fillBox(x - 3*s, y, s, 3*s);
  fillBox(x + 2*s, y, s, 3*s);
  ctx.fillStyle = '#1e293b';
  fillBox(x - 3*s, y - 6*s, s, 4*s);
  fillBox(x + 2*s, y - 6*s, s, 4*s);
  fillBox(x - 3*s, y - 6*s, 6*s, s);
}

function fillBox(x,y,w,h) { ctx.fillRect(Math.round(x), Math.round(y), Math.round(w), Math.round(h)); }

function roundRect(x,y,w,h,r) {
  ctx.beginPath();
  ctx.moveTo(x+r,y); ctx.lineTo(x+w-r,y); ctx.quadraticCurveTo(x+w,y,x+w,y+r);
  ctx.lineTo(x+w,y+h-r); ctx.quadraticCurveTo(x+w,y+h,x+w-r,y+h);
  ctx.lineTo(x+r,y+h); ctx.quadraticCurveTo(x,y+h,x,y+h-r);
  ctx.lineTo(x,y+r); ctx.quadraticCurveTo(x,y,x+r,y);
  ctx.closePath();
}

function shadeColor(col, pct) {
  let num = parseInt(col.replace('#',''),16);
  let r = Math.min(255,Math.max(0,((num>>16)&0xff)+pct));
  let g = Math.min(255,Math.max(0,((num>>8)&0xff)+pct));
  let b = Math.min(255,Math.max(0,(num&0xff)+pct));
  return `rgb(${r},${g},${b})`;
}

// ‚îÄ‚îÄ Zone Layout ‚îÄ‚îÄ
const ZONES = {
  ops:      { label:'üè¢ OPS / COMMAND', x:0.15, y:0.22, cols:2 },
  eng:      { label:'‚öôÔ∏è ENGINEERING',    x:0.55, y:0.18, cols:3 },
  mkt:      { label:'üìà MARKETING',      x:0.15, y:0.55, cols:3 },
  sales:    { label:'üí∞ SALES',          x:0.55, y:0.52, cols:1 },
  research: { label:'üî¨ RESEARCH',       x:0.55, y:0.72, cols:3 },
  server:   { label:'üñ•Ô∏è SERVER ROOM',    x:0.15, y:0.82, cols:1 },
};

function getAgentPositions() {
  const positions = [];
  const zoneAgents = {};
  AGENTS.forEach(a => {
    if (!zoneAgents[a.zone]) zoneAgents[a.zone] = [];
    zoneAgents[a.zone].push(a);
  });
  for (const [zid, zone] of Object.entries(ZONES)) {
    const agents = zoneAgents[zid] || [];
    const baseX = zone.x * W;
    const baseY = zone.y * H;
    const spacing = 120 * scale;
    agents.forEach((a, i) => {
      const col = i % zone.cols;
      const row = Math.floor(i / zone.cols);
      positions.push({
        agent: a,
        x: baseX + col * spacing,
        y: baseY + row * (100 * scale) + 30 * scale,
      });
    });
  }
  return positions;
}

// ‚îÄ‚îÄ Floor Drawing ‚îÄ‚îÄ
function drawFloor() {
  // Grid lines
  ctx.strokeStyle = 'rgba(59,130,246,0.04)';
  ctx.lineWidth = 1;
  const gs = 40 * scale;
  for (let x = 0; x < W; x += gs) { ctx.beginPath(); ctx.moveTo(x,0); ctx.lineTo(x,H); ctx.stroke(); }
  for (let y = 0; y < H; y += gs) { ctx.beginPath(); ctx.moveTo(0,y); ctx.lineTo(W,y); ctx.stroke(); }

  // Zone labels & borders
  for (const [zid, zone] of Object.entries(ZONES)) {
    const zx = zone.x * W - 30*scale;
    const zy = zone.y * H - 20*scale;
    const agents = AGENTS.filter(a => a.zone === zid);
    const zw = Math.max(zone.cols, 1) * 120 * scale + 20*scale;
    const rows = Math.ceil(agents.length / zone.cols);
    const zh = rows * 100 * scale + 50*scale;

    // Zone background
    ctx.fillStyle = zid === 'server' ? 'rgba(244,63,94,0.03)' : 'rgba(59,130,246,0.03)';
    roundRect(zx, zy, zw, zh, 8*scale); ctx.fill();
    ctx.strokeStyle = zid === 'server' ? 'rgba(244,63,94,0.15)' : 'rgba(59,130,246,0.1)';
    ctx.lineWidth = 1;
    roundRect(zx, zy, zw, zh, 8*scale); ctx.stroke();

    // Label
    ctx.fillStyle = '#475569';
    ctx.font = `${7*scale}px 'Press Start 2P'`;
    ctx.textAlign = 'left';
    ctx.fillText(zone.label, zx + 8*scale, zy + 12*scale);
  }

  // Server room extras
  if (scale > 0.5) {
    const sx = ZONES.server.x * W - 20*scale;
    const sy = ZONES.server.y * H - 10*scale;
    for (let i = 0; i < 3; i++) {
      ctx.fillStyle = '#0f172a';
      fillBox(sx + 100*scale + i*16*scale, sy + 10*scale, 12*scale, 60*scale);
      // blinking LEDs
      for (let j = 0; j < 4; j++) {
        ctx.fillStyle = Math.random() > 0.3 ? '#22c55e' : '#0f172a';
        fillBox(sx + 102*scale + i*16*scale, sy + 15*scale + j*12*scale, 3*scale, 3*scale);
        ctx.fillStyle = Math.random() > 0.5 ? '#3B82F6' : '#0f172a';
        fillBox(sx + 107*scale + i*16*scale, sy + 15*scale + j*12*scale, 3*scale, 3*scale);
      }
    }
  }
}

// ‚îÄ‚îÄ Particles ‚îÄ‚îÄ
const particles = [];
function spawnParticle(x, y) {
  particles.push({ x, y, vx:(Math.random()-.5)*2, vy:-Math.random()*2-1, life:30+Math.random()*20, maxLife:50 });
}
function updateParticles() {
  for (let i = particles.length-1; i >= 0; i--) {
    const p = particles[i];
    p.x += p.vx; p.y += p.vy; p.life--;
    if (p.life <= 0) { particles.splice(i,1); continue; }
    const a = p.life / p.maxLife;
    ctx.fillStyle = `rgba(59,130,246,${a*0.6})`;
    fillBox(p.x, p.y, 2*scale, 2*scale);
  }
}

// ‚îÄ‚îÄ Stats Bar ‚îÄ‚îÄ
function updateStats() {
  const counts = { running:0, idle:0, stopped:0, waiting:0 };
  AGENTS.forEach(a => counts[a.status]++);
  document.getElementById('stats').innerHTML =
    `<span><span class="dot dot-green"></span>${counts.running} running</span>` +
    `<span><span class="dot dot-yellow"></span>${counts.idle} idle</span>` +
    `<span><span class="dot dot-red"></span>${counts.stopped} stopped</span>`;
}
updateStats();

// ‚îÄ‚îÄ Click Handler ‚îÄ‚îÄ
let agentPositions = [];
canvas.addEventListener('click', e => {
  const rect = canvas.getBoundingClientRect();
  const mx = e.clientX - rect.left, my = e.clientY - rect.top;
  const hit = agentPositions.find(p => Math.abs(mx - p.x) < 30*scale && Math.abs(my - p.y) < 40*scale);
  const popup = document.getElementById('popup');
  if (!hit) { popup.style.display = 'none'; return; }
  const a = hit.agent;
  const statusClass = `sb-${a.status}`;
  document.getElementById('popup-content').innerHTML =
    `<div class="agent-name">${a.emoji} ${a.name}</div>` +
    `<div>Role: ${a.role}</div>` +
    `<div>Status: <span class="status-badge ${statusClass}">${a.status.toUpperCase()}</span></div>` +
    `<br><div>Last: ${a.lastActivity}</div>`;
  popup.style.display = 'block';
  popup.style.left = Math.min(e.clientX + 10, W - 300) + 'px';
  popup.style.top = Math.min(e.clientY + 10, H - 200) + 'px';
});

// ‚îÄ‚îÄ Main Loop ‚îÄ‚îÄ
let frame = 0;
function draw() {
  ctx.clearRect(0, 0, W, H);
  drawFloor();
  agentPositions = getAgentPositions();
  agentPositions.forEach(p => {
    drawPixelChar(p.x, p.y, p.agent, frame);
    // Spawn particles for running agents
    if (p.agent.status === 'running' && frame % 12 === 0) spawnParticle(p.x + (Math.random()-0.5)*20*scale, p.y - 6*scale);
  });
  updateParticles();
  frame++;
  requestAnimationFrame(draw);
}
draw();

// ‚îÄ‚îÄ Simulate status changes every 8s ‚îÄ‚îÄ
setInterval(() => {
  const a = AGENTS[Math.floor(Math.random() * AGENTS.length)];
  const states = ['running','running','running','idle','waiting'];
  a.status = states[Math.floor(Math.random() * states.length)];
  updateStats();
}, 8000);
</script>
</body>
</html>
